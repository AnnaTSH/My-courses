# Симулятор Аналитика (Karpov.Courses)

### Airflow:
[DAG в Airflow](https://github.com/AnnaTSH/my-courses/blob/master/Analytics_Simulator_Karpov.courses/dag_atimoshenko.py), который запускается каждый день, обрабатывает вчера. 
  1. Параллельно обрабатываются две таблицы. В feed_actions для каждого юзера посчитаем число просмотров и лайков контента. В message_actions для каждого юзера считаем, сколько он получает и отсылает сообщений, скольким людям он пишет, сколько людей пишут ему. Каждая выгрузка должна быть в отдельном таске.
  2. Далее объединяем две таблицы в одну.
  3. Для этой таблицы считаем все эти метрики в разрезе по полу, возрасту и ос. Делаем три разных таска на каждый срез.
  4. И финальные данные со всеми метриками записываем в отдельную таблицу в ClickHouse (структура таблицы: Дата - event_date; Название среза - dimension; Значение среза - dimension_value; Число просмотров - views; Числой лайков - likes; Число полученных сообщений - messages_received; Число отправленных сообщений - messages_sent; От скольких пользователей получили сообщения - users_received; Скольким пользователям отправили сообщение - users_sent; Срез - это os, gender и age

[Скрипт сборки отчёта (Airflow + Telegram)](https://github.com/AnnaTSH/my-courses/blob/master/Analytics_Simulator_Karpov.courses/bot.py): автоматизация базовой отчетности приложения; аналитическая сводка отправляется в телеграм каждое утро

Отчет состоит из двух частей:

* текст с информацией о значениях ключевых метрик за предыдущий день
* график с значениями метрик за предыдущие 7 дней
В отчёте отображены ключевые метрики: DAU, Просмотры, Лайки, CTR

### Задания по теме A/B-тестирование (ноутбуки):

[Проверка работы системы сплитования](https://github.com/AnnaTSH/my-courses/blob/master/Analytics_Simulator_Karpov.courses/task_5-1.ipynb):
На данных АА-теста с '2022-07-06' по '2022-07-12' сделать симуляцию, как будто мы провели 10000 АА-тестов. На каждой итерации вам нужно сформировать подвыборки без повторения в 500 юзеров из 2 и 3 экспериментальной группы. Провести сравнение этих подвыборок t-testом.

[Анализ результатов A/B-теста](https://github.com/AnnaTSH/my-courses/blob/master/Analytics_Simulator_Karpov.courses/task_5-2.ipynb):
Эксперимент проходил с 2022-07-13 по 2022-07-19 включительно. Для эксперимента были задействованы 2 и 1 группы. В группе 2 был использован один из новых алгоритмов рекомендации постов, группа 1 использовалась в качестве контроля. 

Основная гипотеза заключается в том, что новый алгоритм во 2-й группе приведет к увеличению CTR

[A/B-тест: Анализ с использованием метрики линеаризованных лайков](https://github.com/AnnaTSH/my-courses/blob/master/Analytics_Simulator_Karpov.courses/task_5-3.ipynb):
- Считаем общий CTR в контрольной группе  𝐶𝑇𝑅𝑐𝑜𝑛𝑡𝑟𝑜𝑙=𝑠𝑢𝑚(𝑙𝑖𝑘𝑒𝑠)/𝑠𝑢𝑚(𝑣𝑖𝑒𝑤𝑠) 
- Посчитаем в обеих группах поюзерную метрику  𝑙𝑖𝑛𝑒𝑎𝑟𝑖𝑧𝑒𝑑_𝑙𝑖𝑘𝑒𝑠=𝑙𝑖𝑘𝑒𝑠−𝐶𝑇𝑅𝑐𝑜𝑛𝑡𝑟𝑜𝑙∗𝑣𝑖𝑒𝑤𝑠 
- После чего сравним  t-тестом отличия в группах по метрике 𝑙𝑖𝑛𝑒𝑎𝑟𝑖𝑧𝑒𝑑_𝑙𝑖𝑘𝑒𝑠
